<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calvin Real Estate Agencies ‚Äì Nairobi Premium Properties</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"><meta name="description" content="Calvin Real Estate Agencies - Premium houses, apartments & land for sale in Nairobi, Westlands, Kileleshwa, Karen. Direct deals. No agents.">
<meta property="og:title" content="Calvin Real Estate - Premium Properties Nairobi">
<meta property="og:description" content="Direct owner deals ‚Ä¢ Ready titles ‚Ä¢ Verified properties">
<meta property="og:image" content="https://calvinrealestate-3.onrender.com/static/hero.jpg">
<link rel="canonical" href="https://calvinrealestate-3.onrender.com">

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XXXXXXX');  // replace with your real ID later
</script>
</head>
<body>

<header>
    <nav>
        <h1>Calvin Real Estate</h1>
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#properties">Properties</a></li>
            <li><a href="#gallery">Listings</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
    </nav>
</header>

<section class="hero" id="home">
    <h2>Your Dream Home Awaits</h2>
    <p>Premium properties in Nairobi ‚Ä¢ Direct owner deals ‚Ä¢ Zero broker drama</p>
    <a href="#contact" class="btn-hero">Talk to Calvin Now</a>
</section>

<section id="about">
    <h2>About Us</h2>
    <p>We specialize in connecting serious buyers with serious sellers across Nairobi since 2025. No middlemen. No stress. Just results.</p>
</section>

<section id="properties">
    <h2>Featured Properties</h2>
    <div class="property-grid">
        <article class="property-card">
            <img src="{{ url_for('static', filename='pexels2.jpeg') }}" alt="Luxury Villa">
            <h3>Luxury Villa ‚Äì Westlands</h3>
            <p>5 Bed ‚Ä¢ 4 Bath ‚Ä¢ Pool ‚Ä¢ KES 65M</p>
        </article>
        <article class="property-card">
            <img src="{{ url_for('static', filename='pexels3.jpeg') }}" alt="Modern Apartment">
            <h3 Penthouse ‚Äì Kileleshwa</h3>
            <p>3 Bed ‚Ä¢ City View ‚Ä¢ KES 28M</p>
        </article>
    </div>
</section>

<!-- DYNAMIC GALLERY ‚Äì BULLETPROOF VERSION -->
<section id="gallery">
    <h2>Latest Listings</h2>
    <div class="gallery" id="property-container">
        <p style="text-align:center;color:#888;font-size:1.1rem;">Loading properties...</p>
    </div>
</section>

<section id="contact">
    <h2>Contact Calvin Directly</h2>
    <p>üìû <strong>0796 250 286</strong> ‚Ä¢ Available on WhatsApp</p>
    <form id="contactForm">
        <input type="text" id="name" placeholder="Your Name" required>
        <input type="email" id="email" placeholder="Your Email or Phone" required>
        <textarea id="message" placeholder="Tell me what you're looking for..." required></textarea>
        <button type="submit">Send Message ‚Üí</button>
    </form>
    <div id="toast" class="toast"></div>
</section>

<footer>
    <p>¬© 2025 Calvin Real Estate Agencies | Nairobi, Kenya</p>
</footer>

<script>
// BULLETPROOF GALLERY LOADER ‚Äì FINAL VERSION
fetch('/static/properties.json?' + new Date().getTime())
  .then(res => {
    if (!res.ok) throw new Error('Failed to load properties.json');
    return res.json();
  })
  .then(props => {
    const container = document.getElementById('property-container');
    container.innerHTML = '';

    if (!props || props.length === 0) {
      container.innerHTML = '<p style="text-align:center;color:#888;">No listings yet ‚Äî add some in /admin!</p>';
      return;
    }

    props.forEach(p => {
      const article = document.createElement('article');
      article.className = 'property';
      article.innerHTML = `
        <img src="/static/gallery/${p.img}" alt="${p.title}" onerror="this.style.display='none';this.nextElementSibling.style.color='gold';this.nextElementSibling.textContent='Image not found'">
        <h3>${p.title}</h3>
        <p>${p.desc}</p>
        <p style="font-weight:bold;color:gold;font-size:1.5rem;margin-top:10px;">${p.price}</p>
      `;
      container.appendChild(article);
    });
  })
  .catch(err => {
    console.error('Gallery error:', err);
    document.getElementById('property-container').innerHTML = 
      '<p style="color:red;text-align:center;">Failed to load listings ‚Äî refresh or contact admin</p>';
  });

// Contact form toast (unchanged)
const form = document.getElementById('contactForm');
const toast = document.getElementById('toast');
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const data = {
    name: document.getElementById('name').value,
    email: document.getElementById('email').value,
    message: document.getElementById('message').value
  };
  try {
    const res = await fetch('/contact', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(data)
    });
    const json = await res.json();
    showToast(json.message || 'Sent!', false);
    form.reset();
  } catch {
    showToast('Network error ‚Äì try again', true);
  }
});
function showToast(msg, error=false) {
  toast.textContent = msg;
  toast.style.background = error ? 'darkred' : '#001f3f';
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 4000);
}
</script>

<style>
.toast { position:fixed; bottom:20px; left:50%; transform:translateX(-50%); padding:15px 30px; color:white; border-radius:8px; opacity:0; transition:0.4s; z-index:999; }
.toast.show { opacity:1; bottom:40px; }
</style><button id="darkModeToggle" style="position:fixed;top:20px;right:20px;z-index:999;background:gold;color:#001f3f;padding:10px 15px;border:none;border-radius:50px;font-weight:bold;box-shadow:0 4px 15px rgba(0,0,0,0.3);cursor:pointer;">üåô Dark Mode</button>

<script>
const toggle = document.getElementById('darkModeToggle');
toggle.onclick = () => {
  document.body.classList.toggle('dark-mode');
  toggle.textContent = document.body.classList.contains('dark-mode') ? '‚òÄÔ∏è Light' : 'üåô Dark';
};
</script>

<style>
body.dark-mode { background:#121212; color:#eee; }
body.dark-mode header, body.dark-mode footer { background:#001f3f; }
body.dark-mode .property, body.dark-mode .property-card { background:#1e1e1e; }
body.dark-mode section { background:#121212; }
</style>

</body>
</html>